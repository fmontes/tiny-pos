"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function addProduct(t){var e=!model.itemExist(t.barcode);model.addItem(t),e?addProductInList(t):updateProductInList(t),setInvoice()}function addProductInList(t){$productList.appendChild(getProductListItem(t))}function getExistingProductItem(t){return document.querySelector('li[data-barcode="'+t+'"]')}function getProductListItem(t){var e=document.createDocumentFragment(),n=document.createElement("li");return n.dataset.barcode=t.barcode,n.classList.add("products__item"),n.innerHTML='\n        <span class="products__quantity">\n            <span class="products__quantity-number">1</span>\n            <span class="products__quantity-separator">x</span>\n        </span>\n        <span class="products__name">'+t.name+'</span>\n        <span class="products__price">'+t.price.toCurrency()+"</span>\n    ",e.appendChild(n),e}function getProductsShortcutItems(t){var e=document.createDocumentFragment();return t.forEach(function(t){var n=document.createElement("img");n.src="images/products/"+t.image,n.dataset.barcode=t.barcode,e.appendChild(n)}),e}function getSubtotal(){return model.getAll().reduce(function(t,e){return t+e.price*e.quantity},0)}function getTax(){return.13*getSubtotal()}function getTotal(){return getSubtotal()+getTax()}function getPageState(){return $wrapper.classList.contains("payment")?"payment":"home"}function goToDone(){$wrapper.classList.add("done"),setTimeout(function(){$wrapper.classList.remove("payment"),resetApp()},150),setTimeout(function(){$wrapper.classList.remove("done")},800)}function goToHome(){$wrapper.classList.remove("payment"),$primaryButton.style.width=$primaryButton.offsetWidth+"px"}function goToPayment(){$wrapper.classList.add("payment"),$primaryButton.removeAttribute("style")}function navigate(){"home"===getPageState()?goToPayment():goToDone()}function resetApp(){$cashPayingField.value="",$cashChangeAmmount.innerHTML=parseInt("0").toCurrency(),$productList.innerHTML="",$subtotal.innerHTML="",$tax.innerHTML="",$totalAmmount.innerHTML="",$primaryButton.setAttribute("disabled",!0),$total.classList.remove("show"),model.reset()}function setInvoice(t){$subtotal.innerHTML=getSubtotal().toCurrency(),$tax.innerHTML=getTax().toCurrency(),$totalAmmount.innerHTML=getTotal().toCurrency(),$cardAmmountField.innerHTML=$totalAmmount.innerHTML}function updateProductInList(t){var e=getExistingProductItem(t.barcode),n=model.getItemProperty(t.barcode,"quantity");e.querySelector(".products__quantity-number").innerHTML=n,e.querySelector(".products__price").innerHTML=(t.price*n).toCurrency()}function getProduct(t){return data.find(function(e){return e.barcode===t})}var data=[{barcode:"123",name:"Adidas shoes",price:120,image:"adidas-shoes.jpg"},{barcode:"456",name:"Casio Watch",price:90,image:"casio-watch.jpg"},{barcode:"789",name:"Marvel Shirt",price:60,image:"marvel-shirt.jpg"},{barcode:"321",name:"Nike Short",price:12e3,image:"nike-shorts.jpg"},{barcode:"654",name:"Oakley Sunglasses",price:12e3,image:"oakley-sunglasess.jpg"},{barcode:"987",name:"Volcon Pants",price:12e3,image:"volcon-pants.jpg"}],_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,n,a){return n&&t(e.prototype,n),a&&t(e,a),e}}(),stateMap=new Map,State=function(){function t(e){_classCallCheck(this,t),this.key=e}return _createClass(t,[{key:"addItem",value:function(t){var e=stateMap.get(t[this.key]);e?(e.quantity++,stateMap.set(e[this.key],e)):(t.quantity=1,stateMap.set(t[this.key],t))}},{key:"getAll",value:function(){return Array.from(stateMap.values())}},{key:"getItem",value:function(t){return stateMap.get(t)}},{key:"getItemProperty",value:function(t,e){return this.getItem(t)[e]}},{key:"itemExist",value:function(t){return stateMap.has(t)}},{key:"isNotEmpty",value:function(){return!!stateMap.size}},{key:"reset",value:function(){stateMap.clear()}}]),t}();Number.prototype.toCurrency=function(){return this.toLocaleString("en-US",{style:"currency",currency:"USD"})};var $backButton=document.querySelector(".actions__back"),$cardAmmountField=document.querySelector(".card__ammout"),$cashChangeAmmount=document.querySelector(".cash__change-ammout"),$cashPayingField=document.querySelector(".cash__paying-field"),$paymentMethodSelector=document.querySelector(".actions__payment-method"),$primaryButton=document.querySelector(".actions__payment"),$productList=document.querySelector(".products"),$productsShortcuts=document.querySelector(".products-shortcut"),$subtotal=document.querySelector(".subtotal__ammount"),$tax=document.querySelector(".tax__ammount"),$total=document.querySelector(".total"),$totalAmmount=document.querySelector(".total__ammount"),$wrapper=document.querySelector(".wrapper"),model=new State("barcode");$primaryButton.style.width=$primaryButton.offsetWidth+"px",$primaryButton.addEventListener("click",navigate),$paymentMethodSelector.addEventListener("click",function(t){t.target.classList.contains("payment-method--selected")||(document.querySelector(".payment-selected").classList.toggle("payment-selected--card"),document.querySelector(".payment-method--selected").classList.remove("payment-method--selected"),t.target.classList.toggle("payment-method--selected"))}),$backButton.addEventListener("click",goToHome),$cashPayingField.addEventListener("keyup",function(t){$cashChangeAmmount.innerHTML=t.target.value?(t.target.value-getTotal()).toCurrency():parseInt("0").toCurrency()}),$productsShortcuts.appendChild(getProductsShortcutItems(data)),$productsShortcuts.style="min-width: "+100*data.length+"px",$productsShortcuts.addEventListener("click",function(t){addProduct(getProduct(t.target.dataset.barcode)),model.isNotEmpty()&&($primaryButton.removeAttribute("disabled"),$total.classList.add("show"))});